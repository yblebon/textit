
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encrypt & Decrypt</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .menu-buttons { margin-bottom: 20px; }
        button { margin: 0 10px; padding: 10px; cursor: pointer; }
        .menu { display: none; margin-top: 20px; }
        input { display: block; margin: 10px 0; padding: 8px; width: 100%; max-width: 400px; }
        .password-container { position: relative; }
        .toggle-btn { position: absolute; right: 10px; top: 10px; cursor: pointer; }
        .result { margin-top: 20px; padding: 10px; background-color: #f0f0f0; white-space: pre-wrap; }
        .upload-section { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Encrypt & Decrypt Tool</h1>
    <div class="menu-buttons">
        <button onclick="showMenu('encrypt')">Encrypt</button>
        <button onclick="showMenu('decrypt')">Decrypt</button>
    </div>

    <div id="encrypt-menu" class="menu">
        <h2>Encrypt</h2>
        <textarea id="encrypt-text" placeholder="Enter text to encrypt"></textarea>
        <div class="password-container">
            <input type="password" id="encrypt-password" placeholder="Enter password">
            <button class="toggle-btn" onclick="togglePassword('encrypt-password')">Show</button>
        </div>
        <input type="password" id="confirm-password" placeholder="Confirm password">
        <button onclick="encryptText()">Encrypt</button>
        <div id="encrypt-result" class="result"></div>
        <div class="upload-section" id="upload-section" style="display: none;">
            <h3>Upload to GitHub</h3>
            <input type="text" id="repo-owner" placeholder="Repository Owner (e.g., username)">
            <input type="text" id="repo-name" placeholder="Repository Name">
            <input type="password" id="github-token" placeholder="GitHub Personal Access Token">
            <input type="text" id="workflow-filename" placeholder="Workflow Filename (e.g., upload.yml)" value="upload.yml">
            <button onclick="uploadToGitHub()">Upload</button>
            <div id="upload-result" class="result"></div>
        </div>
    </div>

    <div id="decrypt-menu" class="menu">
        <h2>Decrypt</h2>
        <textarea id="decrypt-text" placeholder="Enter encrypted text or paste from URL"></textarea>
        <input type="url" id="decrypt-url" placeholder="Or enter URL to fetch encrypted text">
        <div class="password-container">
            <input type="password" id="decrypt-password" placeholder="Enter password">
            <button class="toggle-btn" onclick="togglePassword('decrypt-password')">Show</button>
        </div>
        <button onclick="decryptText()">Decrypt</button>
        <div id="decrypt-result" class="result"></div>
    </div>

    <script>
        const randomWords = ['apple', 'banana', 'cherry', 'date', 'elderberry', 'fig', 'grape', 'honeydew', 'kiwi', 'lemon', 'mango', 'nectarine', 'orange', 'peach', 'quince', 'raspberry', 'strawberry', 'tangerine', 'ugli', 'vanilla', 'watermelon', 'xigua', 'yam', 'zucchini', 'avocado', 'blueberry', 'cantaloupe', 'dragonfruit', 'eggplant', 'feijoa', 'guava', 'huckleberry', 'jackfruit', 'kumquat', 'lime', 'mulberry', 'olive', 'papaya', 'quinoa', 'rambutan', 'soursop', 'tomato', 'ube', 'velvet', 'walnut', 'xylophone', 'yuzu', 'zest', 'almond', 'breadfruit', 'coconut', 'durian', 'elder', 'fennel', 'ginger', 'hazelnut', 'indigo', 'jasmine', 'kale', 'lavender', 'mint', 'nutmeg', 'oregano', 'parsley', 'quail', 'rosemary', 'sage', 'thyme', 'unicorn', 'violet', 'willow', 'xander', 'yarrow', 'zephyr'];

        function generateFilename() {
            const words = [];
            for (let i = 0; i < 3; i++) {
                words.push(randomWords[Math.floor(Math.random() * randomWords.length)]);
            }
            return words.join('-') + '.txt';
        }

        async function getClientInfo() {
            const browserInfo = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine
            };
            let ipAddress = 'Unable to fetch';
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                ipAddress = data.ip;
            } catch (e) {
                console.log('Error fetching IP:', e);
            }
            return { browserInfo, ipAddress };
        }

        let currentEncryptedData = '';

        async function encryptText() {
            const text = document.getElementById('encrypt-text').value;
            const password = document.getElementById('encrypt-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            const resultDiv = document.getElementById('encrypt-result');

            if (!text || !password) {
                resultDiv.textContent = 'Please fill in all fields.';
                return;
            }
            if (password !== confirmPassword) {
                resultDiv.textContent = 'Passwords do not match.';
                return;
            }

            const { browserInfo, ipAddress } = await getClientInfo();
            const data = {
                text: text,
                browserInfo: browserInfo,
                ipAddress: ipAddress,
                timestamp: new Date().toISOString()
            };
            const jsonData = JSON.stringify(data);
            const encrypted = CryptoJS.AES.encrypt(jsonData, password).toString();
            currentEncryptedData = encrypted;
            resultDiv.textContent = 'Encrypted Data:\n' + encrypted;
            document.getElementById('upload-section').style.display = 'block';
        }

        async function decryptText() {
            let text = document.getElementById('decrypt-text').value;
            const url = document.getElementById('decrypt-url').value;
            const password = document.getElementById('decrypt-password').value;
            const resultDiv = document.getElementById('decrypt-result');

            if (!password) {
                resultDiv.textContent = 'Please enter the password.';
                return;
            }

            if (url && !text) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error('Failed to fetch from URL');
                    text = await response.text();
                } catch (e) {
                    resultDiv.textContent = `Error fetching from URL: ${e.message}`;
                    return;
                }
            }

            if (!text) {
                resultDiv.textContent = 'Please enter encrypted text or provide a URL.';
                return;
            }

            try {
                const decrypted = CryptoJS.AES.decrypt(text, password).toString(CryptoJS.enc.Utf8);
                if (!decrypted) throw new Error('Invalid password or text.');
                const data = JSON.parse(decrypted);
                resultDiv.textContent = 'Decrypted Data:\n' + JSON.stringify(data, null, 2);
            } catch (e) {
                resultDiv.textContent = 'Decryption failed. Check your password or encrypted text.';
            }
        }

        async function uploadToGitHub() {
            const owner = document.getElementById('repo-owner').value;
            const repo = document.getElementById('repo-name').value;
            const token = document.getElementById('github-token').value;
            const workflowFilename = document.getElementById('workflow-filename').value;
            const uploadResultDiv = document.getElementById('upload-result');

            if (!owner || !repo || !token || !workflowFilename || !currentEncryptedData) {
                uploadResultDiv.textContent = 'Please fill in all fields and ensure data is encrypted.';
                return;
            }

            const filename = generateFilename();

            try {
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/actions/workflows/${workflowFilename}/dispatches`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github/v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ref: 'main',
                        inputs: {
                            encrypted_data: currentEncryptedData,
                            filename: filename
                        }
                    })
                });

                if (response.ok) {
                    uploadResultDiv.textContent = `Upload triggered successfully. File will be created as: ${filename}`;
                } else {
                    const error = await response.json();
                    uploadResultDiv.textContent = `Error: ${error.message}`;
                }
            } catch (e) {
                uploadResultDiv.textContent = `Error: ${e.message}`;
            }
        }

        function showMenu(menu) {
            document.getElementById('encrypt-menu').style.display = 'none';
            document.getElementById('decrypt-menu').style.display = 'none';
            document.getElementById(menu + '-menu').style.display = 'block';
        }

        function togglePassword(id) {
            const input = document.getElementById(id);
            const btn = input.nextElementSibling;
            if (input.type === 'password') {
                input.type = 'text';
                btn.textContent = 'Hide';
            } else {
                input.type = 'password';
                btn.textContent = 'Show';
            }
        }
    </script>
</body>
</html>
